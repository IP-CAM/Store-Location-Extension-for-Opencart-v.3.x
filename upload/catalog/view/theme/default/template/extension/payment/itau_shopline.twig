<style>
  @media only screen and (max-width: 767px) {
    #payment .pull-left, #payment input[type="button"] { width: 100% !important; white-space: nowrap !important; text-overflow: ellipsis !important; overflow: hidden !important; }
  }
</style>
{{ instrucoes }}
<div id="alerta">{% if alerta %}<div class="alert alert-warning" role="alert" id="warning">{{ alerta }}</div>{% endif %}</div>
<div class="buttons" id="payment">
  <div class="pull-left">
    <input type="button" value="{{ texto_botao }}" id="button-confirm" class="btn btn-primary btn-lg" data-loading-text="{{ text_confirmando }}" />
  </div>
</div>
<script type="text/javascript"><!--
  function transacao(){
    $('#warning').remove();

    $.ajax({
      url: 'index.php?route=extension/payment/itau_shopline/transacao',
      dataType: 'json',
      beforeSend: function() {
        $('#button-confirm').attr('disabled', true);
        $('#button-confirm').button('loading');
      },
      complete: function() {
        $('#button-confirm').removeAttr('disabled');
        $('#button-confirm').button('reset');
      },
      success: function(json) {
        if (json['error']) {
          $('#alerta').html('<div class="alert alert-warning" role="alert" id="warning">' + json['error'] + '</div>');
        } else if (json['redirect']) {
          $('#button-confirm').hide();
          $('#alerta').html('<div class="alert alert-success">{{ text_confirmado }}</div>');
          location.href = json['redirect'];
        } else {
          $('#alerta').html('<div class="alert alert-warning" role="alert" id="warning">{{ error_configuracao }}</div>');
        }
      },
      error: function(jqXHR, textStatus, errorThrown) {
        if (jqXHR.status == 404 || jqXHR.status == 500 || errorThrown == 'Not Found') {
          $('#alerta').html('<div class="alert alert-warning" role="alert" id="warning">{{ error_configuracao }}</div>');
        }
      }
    });
  }
  $('#button-confirm').click(function() {
      transacao();
  });
//--></script>
